# 【MB】 **退会とアカウント削除** `Unsubscribe & account deletion`

- **カスタマーサポート** 画面のFAQの質問中で退会ボタンをタップしたら、退会処理を行う。退会手続きが完了したら、アカウント削除リクエストを受ける。退会処理後自動的にアカウント情報が削除されます。

## **退会ステップ１** 画面

![nf](image/jp/mb/101member/unsubscribe-1.png)

### 項目／イベント定義

##### 戻る `ボタン`

- このボタンをタップしたら、 **カスタマーサポート** 画面に戻る

##### 理由一覧 `選択肢`

- 退会理由一覧を表示する。複数選択可能
- 理由一覧はAPIからデータを取得して、表示する。

##### その他 `インプット`

- 最大255文字まで入力可能
- このインプットは入力しなくても構いません。スペース入力したら、入力しないと判断する

##### 次へ進む `ボタン`

- ボタンをタップしたら、
    - 入力された情報を検証する
    - エラーがなかったら、 **退会ステップ２** 画面に移動される

### エラー一覧（Error List）

#### 項目エラー（Item Error）

- Max： `255文字以内で入力してください`

## **退会ステップ２** 画面

![nf](image/jp/mb/101member/unsubscribe-2.png)

### 項目／イベント定義

##### 戻る `ボタン`

- このボタンをタップしたら、 **退会ステップ１** 画面に戻る

##### 退会前のプラン確認 `区画`

- APIデータ：
    - `2022年12月22日`: YYYY年mm月dd日　利用最終日

##### 次へ進む `ボタン`

- ボタンをタップしたら、StripeにAPIを呼び出して、現在契約しているプランとオプションを全て退会する
    - エラーが無かったら、 **退会完了** 画面に移動される
    - エラーがあったら、 **退会エラー** 画面に移動される
- 退会したら、全てのオプションを基本料金に紐づいて退会されます。例えば特別のケースが想定される。
    - ユーザーが2022/10/20にキャンペーン利用しなくて、手ぶらと水素水オプションを選択して、会員登録するケース。
    - オプションが２ヶ月無料利用できますが、2022/10/25に退会したら、基本料金・手ぶら・水素は2022/11/19まで利用できるになる。

### エラー一覧（Error List）

`None`

## **退会完了** 画面

![nf](image/jp/mb/101member/unsubscribe-3.png)

### 項目／イベント定義

##### アカウント削除希望 `ボタン`

![nf](image/jp/mb/101member/account-delete-button.png)

- ボタンをタップしたら、 **アカウント削除リクエスト** 画面に移動される

##### 戻る `ボタン`

- このボタンをタップしたら、 **ホーム** 画面に戻る

### エラー一覧（Error List）

`None`

## **退会エラー** 画面

![nf](image/jp/mb/101member/unsubscribe-error-jp.png)

- もしエラーで退会できなかったら、もう一回リトライができる。退会をリトライして、また出来なかったら、また出来なかったら、退会手続きを中止する

### 項目／イベント定義 

##### リトライ `ボタン`

- ボタンをタップしたら、 退会手続きをリトライする
    - エラーが無かったら、 **退会完了** 画面に移動される
    - エラーがあったら、 **退会エラー** 画面に移動して、このボタンを隠す

##### 退会手続きを中止する `ボタン`

- このボタンをタップしたら、 **ホーム** 画面に戻る

### エラー一覧（Error List）

`None`

## **アカウント削除リクエスト** 画面

![nf](image/jp/mb/101member/account-delete-request.png)

### 項目／イベント定義

##### アカウント削除をリクエスト `ボタン`

![nf](image/jp/mb/101member/account-delete-button.png)

- ボタンをタップしたら、アカウント削除リクエストを受け付けて、 `アカウント削除リクエストを受け付けました` 画面に移動される
    - `戻る`ボタンをタップしたら、 **ホーム** 画面に移動される
- 利用最終日が経ったら、Batchを実施して、ユーザーの情報を別の情報を別のテーブルに移行して、ユーザーのセッションやtokenをクリアする。
- アカウント削除処理が完了したら、ユーザーがアプリを開くと、ログアウトされて、削除したアカウントの電話番号で新規登録ができる

##### キャンセル `ボタン`

- このボタンをタップしたら、 **ホーム** 画面に戻る

### エラー一覧（Error List）

`None`

## **アカウント削除リクエストのキャンセル** 画面

![nf](image/jp/mb/101member/cancel-account-delete-request.png)

### 項目／イベント定義

##### 削除リクエストをキャンセル `ボタン`

- ボタンをタップしたら、アカウント削除リクエストをキャンセルして、 `アカウント削除リクエストを解除しました。` 画面に移動される
    - `戻る`ボタンをタップしたら、 **ホーム** 画面に移動される

##### キャンセル `ボタン`

- このボタンをタップしたら、 **ホーム** 画面に戻る

### エラー一覧（Error List）

`None`