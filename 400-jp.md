# 【DOOR-MAN】 **ドアマン** `Door man`

## **ログイン** 画面

![nf](image/jp/dm/400doorman/log-in.png)
![nf](image/jp/dm/400doorman/log-in-error.png)


### 項目／イベント定義

##### 電話番号  `インプット`

- 必須入力。メールのフォーマットチェックあり。

##### パスワード  `インプット`

- 必須入力。Char型（大文字、小文字、数字が含まれる）。8桁以上20桁以内。

##### パスワード表示・パスワード非表示  `ボタン` 

- 押下すると、パスワードを表示・非表示を切り替える

##### ログイン  `ボタン` 

- 押下すると、入力した情報のバリデーションチェックを行う。
   - エラーがない場合、 **施設を選択** 画面に遷移する。
   - エラーがある場合、エラーメッセージを表示し、 **ログイン** 画面にリメインする。

### エラー一覧

####　項目エラー

##### メール `インプット`

未入力
   `メールを入力してください。これは必須です。`

無効のフォーマット
   `メールのフォーマットが無効です。`

##### パスワード  `インプット` 

未入力
   `パスワードを入力してください。 これは必須です。`

無効のフォーマット
   `パスワードのフォーマットが無効です。`

8桁以上20桁以内の桁数制限
   `パスワードは8~20文字以内で入力してください。`

#### 画面エラー

メール、または、パスワードが間違っている場合
   `メールが間違っているかサポートされていないか、パスワードが間違っています。 もう一度やり直してください。`

## **施設を選択** 画面

CMS側のIoT\ゲートで設定しているドアの情報を表示する画面。

![nf](image\jp\dm\400doorman\door-setting.png)

### 項目／イベント定義

##### APIデータ

- `玄関1‐出口`、`手ぶら‐入口`など：ゲート名
- `接続済み`、`切断された`：ゲートの状態。接続済みと切断されたの２つある
- チェックボックス：接続済みのゲートのみチェックできる。切断されたドアはチェックできない。

##### リセット  `ボタン` 

- 押下すると、画面が初期化される

##### 設定  `ボタン` 

- 押下すると、 **QRコード表示** 画面に遷移する。

### エラー一覧

`None`

## **QRコード表示** 画面

 **施設を設定** 画面で設定したドアのQRコードを表示する画面。QRコードが固定であるが、**施設を設定** 画面の設定ボタンが押下されるたびにQRコードが生成されるので、同じドアでも再度設定されるとQRコードが変わる。

![nf](image\jp\dm\400doorman\qr-code.png)

### 項目／イベント定義

- P `ボタン`：
   - 連続に6回をタップすると、 **キオスクモードを終了する** 画面に遷移する。
   - 3秒間連続でタップする必要があり、3秒以上停止すると最初からカウントされる。

### QRコードをスキャンした後の動き

- QRコードをモバイルアプリで読んだ後、IoTを通してドアを開ける。
   - ドアが正常に開いた場合：
       - **ロックが解除された** の通知画面に遷移する。
       - それぞれのドアの音声を流す。
         入口(0:04)：入口を解除しました。ポケットフィットネスへようこそ。
         出口(0:03)：出口を解除しました。お疲れ様です。
         手ぶらのドア(0:04)：鍵を解除しました。退室時はそのまま退室が可能です。
       - **ロックが解除された** の通知画面で7秒のカウントダウンが終わったら、 **QRコード表示** 画面に遷移する。
   - ドアが正常に開かなかった場合、**エラー**のポップアップを表示する。ポップアップの`戻る`ボタンを押下すると、**QRコード表示** 画面に遷移する。

![nf](image\jp\dm\400doorman\qrcode-scan-flow.PNG)

### エラー一覧

- ドアが正常に開かなかった場合:
   `ドアを開けることができませんでした。お手数ですが、再度やり直してください。`

## **ロックが解除された** の通知画面

![nf](image\jp\dm\400doorman\open-success.png)

- Pは`ボタン`ではなく、アイコンである。押下不可。
- `☑ドアのロックが解除されました。`：固定メッセージ
- 7秒間カウントダウン: 7秒のカウントダウンが終わったら、自動的に **QRコード表示** 画面に遷移する。

## **キオスクモードを終了する** 画面

パスワードを入力して、キオスクモードを終了する画面。

![nf](image\jp\dm\400doorman\input-password.png)

##### パスワード `インプット`

- 必須入力。Char型（大文字、小文字、数字が含まれる）。8桁以上20桁以内。

##### キャンセル `ボタン`

- 押下すると、**QRコードスキャン** 画面に遷移する。

##### 終了 `ボタン`

- 押下すると、入力した情報のバリデーションチェックを行う。
   - エラーがない場合、 **施設を選択** 画面に遷移する。
   - エラーがある場合、エラーメッセージを表示し、**キオスクモードを終了する** 画面にリメインする。

### エラー一覧

未入力
   `パスワードを入力してください。 これは必須です。`

無効のフォーマット
   `パスワードのフォーマットが無効です。`

8桁以上20桁以内の桁数制限
   `パスワードは8~20文字以内で入力してください。`

パスワードが間違っている
   `パスワードが間違っています。 もう一度やり直してください。`

