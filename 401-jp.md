# 【DOOR-MAN】 **施設設定** `Door Setting`

## **施設を選択** 画面

- CMS側のIoT\ゲートで設定しているドアの情報を表示する画面。玄関の出入口は「玄関」エリア、手ぶらの出入口は「手ぶら」エリアに表示する。１つのタブレットに２つのドアを設定することができない、かつ、他のタブレットに接続しているドアを設定できないこと。

![nf](image\jp\dm\400doorman\door-setting-full.png)

- 7つのドア以下ある場合、上にトルツメする。

![nf](image\jp\dm\400doorman\door-setting-1.png)

### 項目／イベント定義

##### ドアの状態分類

- ドアの状態が３つある。接続可能、ほかのタブレットに接続中のため接続不可、問題ありのため接続不可である。

   - 接続可能のドア
     ![nf](image\jp\dm\400doorman\door-type1.PNG)
     ・緑の点があり、背景色も緑
     ・`2`：ドアの番号。APIデータ。CMSのIoTで設定しているデータを表示する。
     ・`玄関1‐出口` :ドア名。APIデータ。CMSのIoTで設定しているデータを表示する。
     ・チェックボックス : 活性
   - ほかのタブレットに接続中のため接続不可のドア
     ![nf](image\jp\dm\400doorman\door-type2.PNG)
     ・緑の点があり、背景色も緑
     ・`3` ：ドアの番号。APIデータ。CMSのIoTで設定しているデータを表示する。
     ・`手ぶら1‐出口` :ドア名。APIデータ。CMSのIoTで設定しているデータを表示する。
     ・`エントリー1` :ドアと接続しているタブレット名。APIデータ。CMSのIoTで設定しているデータを表示する。
     ・チェックボックス : 表示しない
   - 問題ありのため接続不可のドア
     ![nf](image\jp\dm\400doorman\door-type3.PNG)
     ・赤の点があり、背景色も赤い
     ・`2` ：ドアの番号。APIデータ。CMSのIoTで設定しているデータを表示する。
     ・`玄関1‐出口` :ドア名。APIデータ。CMSのIoTで設定しているデータを表示する。
     ・`エントリー1` : 表示しない
     ・チェックボックス : 表示しない

##### チェックボックス

- １つのタブレットに１つのドアしか接続できないため、一つのチェックボックスしかチェックできない。

##### リセット  `ボタン`

- いつも活性する。

- 押下すると、画面が初期化される。選択されていたドアのチェックが外されるし、ドアの接続状態を再取得する。

##### 設定  `ボタン` 

- ドアがひとつも選択されない場合、設定  `ボタン` が非活性である。

- 設定  `ボタン`が活性の場合、押下すると、 許可を求めるポップアップメッセージが表示される。OKを押下すると、**QRコード表示** 画面に遷移する。NOを押下すると、**施設を選択** 画面にリメインする。

### エラー一覧

`None`

## **QRコード表示** 画面

**施設を選択** 画面で設定したドアのQRコードを表示する画面。QRコードが固定であるが、**施設を選択** 画面の設定ボタンが押下されるたびにQRコードが生成されるので、同じドアでも再度設定されるとQRコードが変わる。

![nf](image\jp\dm\400doorman\qr-code1.png)

### 項目／イベント定義

- P `ボタン`：
   - 連続に6回をタップすると、 **キオスクモードを終了する** 画面に遷移する。
   - 3秒間連続でタップする必要があり、3秒以上停止すると最初からカウントされる。
- `GYM NAME` : 設定済みのドアのジム名を表示する。APIデータ。CMSのIoTで設定しているデータを表示する。
- `Gate Name`: 設定済みのドアのドア名を表示する。APIデータ。CMSのIoTで設定しているデータを表示する。

### QRコードをスキャンした後の動き

- QRコードをモバイルアプリで読んだ後、IoTを通してドアを開ける。
   - ドアが正常に開いた場合：
       - **7秒カウントダウン** の画面に遷移する。
       - それぞれのドアの挨拶音声を流す。
         入口(0:04)：入口を解除しました。ポケットフィットネスへようこそ。
         出口(0:03)：出口を解除しました。お疲れ様です。
         手ぶらのドア(0:04)：鍵を解除しました。退室時はそのまま退室が可能です。
       - 7秒のカウントダウンが終わったら、 自動的に **QRコード表示** 画面に遷移する。
   - ドアが正常に開かなかった場合、**エラー**のポップアップを表示する。ポップアップの`戻る`ボタンを押下すると、**QRコード表示** 画面に遷移する。

![nf](image\jp\dm\400doorman\qrcode-scan-flow1.PNG)

### エラー一覧

- ドアが正常に開かなかった場合:
   `ドアを開けることができませんでした。お手数ですが、再度やり直してください。`

## **7秒カウントダウン** の画面

![nf](image\jp\dm\400doorman\countdown.png)

- Pは`ボタン`ではなく、アイコンである。押下不可。
- 7秒カウントダウン: 7秒のカウントダウンが終わったら、自動的に **QRコード表示** 画面に遷移する。
